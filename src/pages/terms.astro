---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<BaseLayout
  title="Terms and Conditions - RaceNode"
  description="Read the terms and conditions for using RaceNode, the racing team management platform. Learn about your rights and responsibilities."
>
  <div class="min-h-screen bg-gray-950 flex flex-col">
    <Header />
    <main class="flex-1">
      <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Header with back button -->
        <div class="mb-8">
          <a
            href="/"
            class="inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors mb-6"
          >
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>
            </svg>
            Back to Home
          </a>
          <h1 class="text-4xl font-bold text-white">Terms and Conditions</h1>
        </div>

        <!-- Document content -->
        <div class="bg-gray-900 border border-gray-800 rounded-xl p-8">
          <div class="prose prose-invert prose-sm max-w-none
            prose-headings:text-white prose-headings:font-bold
            prose-h1:text-3xl prose-h1:mt-8 prose-h1:mb-4
            prose-h2:text-2xl prose-h2:mt-6 prose-h2:mb-3
            prose-h3:text-xl prose-h3:mt-4 prose-h3:mb-2
            prose-p:text-gray-300 prose-p:leading-relaxed prose-p:mb-4
            prose-ul:list-disc prose-ul:list-inside prose-ul:text-gray-300 prose-ul:mb-4 prose-ul:space-y-2
            prose-li:text-gray-300
            prose-strong:text-white prose-strong:font-semibold
            prose-a:text-red-500 hover:prose-a:text-red-400 prose-a:underline
            prose-hr:border-gray-700 prose-hr:my-6">
            <div id="content"></div>
          </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center">
          <a
            href="/"
            class="text-gray-400 hover:text-white transition-colors"
          >
            Return to RaceNode
          </a>
        </div>
      </div>
    </main>
    <Footer />
  </div>
</BaseLayout>

<script>
  async function loadContent() {
    try {
      const response = await fetch('/docs/legal/terms-and-conditions.md');
      if (!response.ok) throw new Error('Failed to load document');
      const markdown = await response.text();

      // Simple markdown to HTML conversion
      const html = markdown
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        .replace(/^\*\*(.+?)\*\*$/gim, '<p><strong>$1</strong></p>')
        .replace(/\*\*(.+?)\*\*/gim, '<strong>$1</strong>')
        .replace(/^- (.+)$/gim, '<li>$1</li>')
        .replace(/(<li>.*<\/li>\n?)+/gim, '<ul>$&</ul>')
        .replace(/^---$/gim, '<hr>')
        .replace(/\[(.+?)\]\((.+?)\)/gim, '<a href="$2" target="_blank" rel="noopener">$1</a>')
        .replace(/^(?!<[huplo]|<li|<hr)(.+)$/gim, '<p>$1</p>')
        .replace(/<p><\/p>/g, '')
        .replace(/\n\n+/g, '\n');

      const contentDiv = document.getElementById('content');
      if (contentDiv) {
        contentDiv.innerHTML = html;
      }
    } catch (error) {
      const contentDiv = document.getElementById('content');
      if (contentDiv) {
        contentDiv.innerHTML = '<p class="text-red-500">Failed to load terms and conditions.</p>';
      }
    }
  }

  loadContent();
</script>
